{
  "id": null,
  "title": "eBPF Programs Performance",
  "tags": ["ebpf", "cpu"],
  "style": "dark",
  "timezone": "browser",
  "editable": true,
  "graphTooltip": 1,
  "panels": [
    {
      "id": 1,
      "title": "eBPF Program CPU Usage",
      "type": "timeseries",
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "min": 0,
          "custom": {
            "axisLabel": "mcores",
            "axisPlacement": "left",
            "drawStyle": "line",
            "lineInterpolation": "smooth",
	    "showPoints": "never",
            "fillOpacity": 20
          }
        },
        "overrides": []
      },
      "targets": [
        {
          "refId": "A",
          "expr": "irate(ebpf_run_time{ebpf_name!=\"\"}[1m]) * 1000",
          "legendFormat": "Name: {{ebpf_name}}, ID: {{ebpf_id}}",
          "interval": ""
        },
        {
          "refId": "B",
          "expr": "sum(irate(ebpf_run_time{ebpf_name!=\"\"}[1m]) * 1000)",
          "legendFormat": "Total",
          "interval": ""
        }
      ],
      "gridPos": { "h": 10, "w": 24, "x": 0, "y": 0 },
      "options": {
        "tooltip": {
          "mode": "single",
          "sort": "none"
        },
        "legend": {
          "showLegend": true,
          "placement": "bottom"
        }
      }
    },
    {
      "id": 2,
      "title": "eBPF events/sec",
      "type": "timeseries",
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "min": 0,
          "custom": {
            "axisLabel": "events",
            "axisPlacement": "left",
            "drawStyle": "line",
	    "showPoints": "never",
            "lineInterpolation": "smooth",
            "fillOpacity": 20
          }
        },
        "overrides": []
      },
      "targets": [
        {
          "refId": "A",
          "expr": "irate(ebpf_event_count{ebpf_name!=\"\"}[1m])",
          "legendFormat": "Name: {{ebpf_name}}, ID: {{ebpf_id}}",
          "interval": ""
        },
        {
          "refId": "B",
          "expr": "sum(irate(ebpf_event_count{ebpf_name!=\"\"}[1m]))",
          "legendFormat": "Total",
          "interval": ""
        }
      ],
      "gridPos": { "h": 10, "w": 24, "x": 0, "y": 0 },
      "options": {
        "tooltip": {
          "mode": "single",
          "sort": "none"
        },
        "legend": {
          "showLegend": true,
          "placement": "bottom"
        }
      }
    },
    {
      "id": 3,
      "title": "eBPF map pressure",
      "type": "timeseries",
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "min": 0,
          "custom": {
            "axisLabel": "elements count",
            "axisPlacement": "left",
            "drawStyle": "line",
	    "showPoints": "never",
            "lineInterpolation": "smooth",
            "fillOpacity": 20
          }
        },
        "overrides": []
      },
      "targets": [
        {
          "refId": "A",
          "expr": "ebpf_map_size{ebpf_map_max_size!=\"1\"}",
          "legendFormat": "Name: {{ebpf_map_name}}, ID: {{ebpf_map_id}}",
          "interval": ""
        }
      ],
      "gridPos": { "h": 10, "w": 24, "x": 0, "y": 0 },
      "options": {
        "tooltip": {
          "mode": "single",
          "sort": "none"
        },
        "legend": {
          "showLegend": true,
          "placement": "bottom"
        }
      }
    }
  ],
  "refresh": "30s",
  "time": { "from": "now-15m", "to": "now" },
  "timepicker": {
    "refresh_intervals": ["10s", "30s", "1m", "5m"],
    "time_options": ["5m", "15m", "1h", "6h", "12h", "24h", "7d"]
  }
}
